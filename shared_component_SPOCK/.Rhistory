##-- Packages ----
library(dplyr)
library(sp)
library(sf)
library(spdep)
library(mvtnorm)
library(INLA)
library(parallel)
##-- Source ----
source('R/utils.R')
##-- Definitions ----
set.seed(123456)
state_fips <- "06"
n_cov <- 2
alpha <- c(0.5, 0.1)
betas_1 <- c(-0.5, -0.2)
betas_2 <- c(-0.8, -0.4)
betas <- matrix(c(betas_1, betas_2), nrow = 2, byrow = TRUE)
tau <- c(1, 5000, 5000)
delta <- c(1, 1.5, 1.75)
n_rep <- 1000
prior <- gamma_prior(mean = 1000, var = 2e+06)
load(sprintf("../../maps/outputs/map_%s.RData", state_fips))
library(tigris)
map_state <- tigris::counties(state = "VA")
map_state <- tigris::counties(state = "CA")
map_state@data$region_id <- row.names(map_state@data)
map_state@data$region_inla <- 1:nrow(map_state@data)
results <- list()
results_conf <- list()
i <- 1
cores = 10
confounding = FALSE
delta = delta[i]
##-- Map ----
nb_list <- spdep::poly2nb(map_state)
W <- spdep::nb2mat(nb_list, style = "B")
n <- length(map_state)
##-- Covariates ----
X <- matrix(rnorm(n = n_cov*n, mean = 0, sd = 1), ncol = n_cov)
confounding
colnames(X) <- paste0("X", 1:ncol(X))
##-- spock ----
spock_nb <- spock(x = cbind(1, X), map = map_state, use_map = TRUE)
W_spock <- spdep::nb2mat(spock_nb, style = "B")
load("~/Documents/git/github/douglas/papers_source/shared_component_SPOCK/outputs/results.RData")
length(results)
length(results[[1]])
length(results[[2]])
length(results[[3]])
lapply(results[[1]], class)
lapply(results[[1]][[1]], class)
results[[1]]
